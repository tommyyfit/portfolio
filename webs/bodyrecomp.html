<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NeoFit | Body Recomp Calculator</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Roboto', sans-serif;
        }
        
        :root {
            --primary: #0f172a;
            --secondary: #1e293b;
            --accent: #00d9ff;
            --accent2: #ff00aa;
            --success: #00ff9d;
            --danger: #ff4d7e;
            --text: #f8fafc;
            --text-secondary: #94a3b8;
            --glass: rgba(30, 41, 59, 0.7);
            --transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        
        body {
            background: linear-gradient(135deg, #0d1b2a, #1b263b);
            color: var(--text);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            overflow-x: hidden;
        }
        
        body::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 10% 20%, rgba(0, 217, 255, 0.1) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(255, 0, 170, 0.1) 0%, transparent 20%);
            z-index: -1;
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            display: grid;
            grid-template-columns: 1fr;
            gap: 30px;
        }
        
        @media (min-width: 992px) {
            .container {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        .card {
            background: var(--glass);
            backdrop-filter: blur(12px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            padding: 30px;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }
        
        .card::before {
            content: "";
            position: absolute;
            top: -1px;
            left: -1px;
            right: -1px;
            height: 5px;
            background: linear-gradient(90deg, var(--accent), var(--accent2));
            z-index: 1;
        }
        
        .card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4);
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        h1 {
            font-size: 2.5rem;
            background: linear-gradient(90deg, var(--accent), var(--accent2));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 10px;
            font-weight: 800;
            letter-spacing: 1px;
        }
        
        .subtitle {
            color: var(--text-secondary);
            font-size: 1.1rem;
            margin-bottom: 30px;
        }
        
        .input-group {
            margin-bottom: 25px;
        }
        
        .input-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .input-row > div {
            flex: 1;
        }
        
        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--text);
            font-size: 1rem;
        }
        
        .input-wrapper {
            position: relative;
        }
        
        input, select {
            width: 100%;
            padding: 16px 20px;
            background: rgba(15, 23, 42, 0.7);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: var(--text);
            font-size: 1rem;
            transition: var(--transition);
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(0, 217, 255, 0.2);
        }
        
        .unit-toggle {
            display: flex;
            background: rgba(15, 23, 42, 0.7);
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .unit-toggle button {
            flex: 1;
            padding: 15px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            position: relative;
        }
        
        .unit-toggle button.active {
            color: var(--text);
            background: rgba(0, 217, 255, 0.1);
        }
        
        .unit-toggle button.active::after {
            content: "";
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--accent);
        }
        
        .intensity-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }
        
        .intensity-option {
            padding: 20px 15px;
            text-align: center;
            background: rgba(15, 23, 42, 0.7);
            border-radius: 12px;
            cursor: pointer;
            transition: var(--transition);
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
        }
        
        .intensity-option:hover {
            transform: translateY(-5px);
            border-color: rgba(0, 217, 255, 0.3);
        }
        
        .intensity-option.active {
            border-color: var(--accent);
            background: rgba(0, 217, 255, 0.1);
        }
        
        .intensity-option h3 {
            margin-bottom: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text);
        }
        
        .intensity-option p {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }
        
        .button-group {
            display: flex;
            gap: 15px;
            margin: 25px 0;
        }
        
        .btn {
            flex: 1;
            padding: 18px;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .btn-primary {
            background: linear-gradient(90deg, var(--accent), var(--accent2));
            color: var(--text);
            box-shadow: 0 5px 15px rgba(0, 217, 255, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 217, 255, 0.4);
        }
        
        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-5px);
        }
        
        .results {
            display: none;
        }
        
        .results-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .result-card {
            background: rgba(15, 23, 42, 0.7);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: var(--transition);
        }
        
        .result-card:hover {
            transform: translateY(-8px);
        }
        
        .muscle-gain {
            border-top: 3px solid var(--success);
        }
        
        .fat-loss {
            border-top: 3px solid var(--danger);
        }
        
        .result-card h3 {
            font-size: 1.2rem;
            margin-bottom: 15px;
            color: var(--text);
        }
        
        .result-value {
            font-size: 2.8rem;
            font-weight: 800;
            margin-bottom: 5px;
            background: linear-gradient(90deg, var(--success), var(--accent));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        .fat-loss .result-value {
            background: linear-gradient(90deg, var(--danger), var(--accent2));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        .result-unit {
            font-size: 1.1rem;
            color: var(--text-secondary);
        }
        
        .disclaimer {
            background: rgba(255, 77, 126, 0.1);
            padding: 20px;
            border-radius: 12px;
            margin-top: 25px;
            border: 1px solid rgba(255, 77, 126, 0.2);
            font-size: 0.95rem;
            line-height: 1.6;
        }
        
        .disclaimer strong {
            color: var(--danger);
        }
        
        .chart-container {
            height: 300px;
            margin-top: 30px;
        }
        
        .error {
            color: var(--danger);
            font-size: 0.9rem;
            margin-top: 8px;
            display: none;
        }
        
        input.invalid {
            border-color: var(--danger);
        }
        
        .floating {
            animation: floating 8s ease-in-out infinite;
        }
        
        @keyframes floating {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
            100% { transform: translateY(0px); }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(0, 217, 255, 0.4); }
            70% { box-shadow: 0 0 0 15px rgba(0, 217, 255, 0); }
            100% { box-shadow: 0 0 0 0 rgba(0, 217, 255, 0); }
        }
        
        /* Enhanced Footer Styling */
        .signature {
            text-align: center;
            margin-top: 30px;
            padding: 20px;
            position: relative;
            overflow: hidden;
            grid-column: 1 / -1;
        }
        
        .signature p {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text);
            letter-spacing: 1px;
            position: relative;
            display: inline-block;
            padding: 10px 30px;
            background: rgba(15, 23, 42, 0.5);
            border-radius: 50px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            transition: var(--transition);
            cursor: default;
        }
        
        .signature p:hover {
            background: rgba(30, 41, 59, 0.8);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 217, 255, 0.3);
        }
        
        .signature p::before {
            content: "";
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            z-index: -1;
            background: linear-gradient(45deg, 
                var(--accent), 
                var(--accent2),
                var(--accent));
            background-size: 400%;
            border-radius: 50px;
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        
        .signature p:hover::before {
            opacity: 1;
            animation: signature-glow 3s linear infinite;
        }
        
        @keyframes signature-glow {
            0% {
                background-position: 0% 50%;
                filter: blur(5px);
            }
            50% {
                background-position: 100% 50%;
                filter: blur(8px);
            }
            100% {
                background-position: 0% 50%;
                filter: blur(5px);
            }
        }
        
        .signature p span {
            background: linear-gradient(90deg, var(--accent), var(--accent2));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            font-weight: 700;
            position: relative;
            z-index: 2;
        }
        
        .signature p::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, 
                rgba(0, 217, 255, 0.1), 
                rgba(255, 0, 170, 0.1),
                rgba(0, 217, 255, 0.1));
            border-radius: 50px;
            z-index: -1;
        }
        
        footer {
            text-align: center;
            padding: 30px 0 10px;
            color: var(--text-secondary);
            font-size: 0.9rem;
            grid-column: 1 / -1;
        }
        
        .feature {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: rgba(15, 23, 42, 0.5);
            border-radius: 12px;
            margin-bottom: 15px;
            transition: var(--transition);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .feature:hover {
            background: rgba(30, 41, 59, 0.7);
            transform: translateX(10px);
        }
        
        .feature i {
            font-size: 1.8rem;
            background: linear-gradient(90deg, var(--accent), var(--accent2));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            min-width: 40px;
        }
        
        .feature h3 {
            font-size: 1.1rem;
            margin-bottom: 5px;
        }
        
        .feature p {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        @media (max-width: 768px) {
            .input-row {
                flex-direction: column;
                gap: 15px;
            }
            
            .results-grid {
                grid-template-columns: 1fr;
            }
            
            .intensity-options {
                grid-template-columns: 1fr;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="card floating">
            <div class="header">
                <h1><i class="fas fa-calculator"></i> NEOFIT RECOMP</h1>
                <p class="subtitle">Calculate your muscle gain and fat loss potential with AI-powered precision</p>
            </div>
            
            <div class="input-group">
                <label for="weight">Current Body Weight</label>
                <div class="input-row">
                    <div class="input-wrapper">
                        <input type="number" id="weight" placeholder="Enter your weight" min="0" step="0.1">
                        <div class="error" id="weight-error">Please enter a valid weight (>0)</div>
                    </div>
                    
                    <div class="unit-toggle">
                        <button type="button" id="unit-lbs" class="active">Pounds (lbs)</button>
                        <button type="button" id="unit-kg">Kilograms (kg)</button>
                    </div>
                </div>
            </div>
            
            <div class="input-group">
                <label for="protein">Daily Protein Intake (grams)</label>
                <input type="number" id="protein" placeholder="Enter protein in grams" min="0" step="1">
                <div class="error" id="protein-error">Please enter valid protein intake</div>
                <p style="color: var(--text-secondary); margin-top: 10px; font-size: 0.9rem;">
                    <i class="fas fa-lightbulb"></i> Optimal range: 0.7-1.0g per lb of body weight
                </p>
            </div>
            
            <div class="input-group">
                <label>Training Intensity Level</label>
                <div class="intensity-options">
                    <div class="intensity-option active" data-value="beginner">
                        <h3><i class="fas fa-seedling"></i> Beginner</h3>
                        <p>&lt; 1 year training</p>
                    </div>
                    <div class="intensity-option" data-value="intermediate">
                        <h3><i class="fas fa-chart-line"></i> Intermediate</h3>
                        <p>1-3 years training</p>
                    </div>
                    <div class="intensity-option" data-value="advanced">
                        <h3><i class="fas fa-fire"></i> Advanced</h3>
                        <p>&gt; 3 years training</p>
                    </div>
                </div>
            </div>
            
            <div class="button-group">
                <button class="btn btn-primary pulse" id="calculate-btn">
                    <i class="fas fa-bolt"></i> Calculate Recomp
                </button>
                <button class="btn btn-secondary" id="reset-btn">
                    <i class="fas fa-undo"></i> Reset
                </button>
            </div>
            
            <div class="features">
                <div class="feature">
                    <i class="fas fa-brain"></i>
                    <div>
                        <h3>AI-Powered Analysis</h3>
                        <p>Advanced algorithms for accurate body recomposition predictions</p>
                    </div>
                </div>
                <div class="feature">
                    <i class="fas fa-sync-alt"></i>
                    <div>
                        <h3>Real-time Adjustments</h3>
                        <p>Dynamic updates as you change your inputs</p>
                    </div>
                </div>
                <div class="feature">
                    <i class="fas fa-chart-network"></i>
                    <div>
                        <h3>Comprehensive Visualization</h3>
                        <p>Interactive charts to visualize your progress</p>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="card">
            <div class="results" id="results">
                <div class="header">
                    <h2><i class="fas fa-chart-bar"></i> RECOMP RESULTS</h2>
                    <p class="subtitle">Your weekly body recomposition analysis</p>
                </div>
                
                <div class="results-grid">
                    <div class="result-card muscle-gain">
                        <h3>Muscle Gain</h3>
                        <div class="result-value" id="muscle-gain">0.00</div>
                        <div class="result-unit" id="muscle-unit">lbs/week</div>
                        <div style="margin-top: 15px; font-size: 0.9rem; color: var(--text-secondary);">
                            <i class="fas fa-arrow-up"></i> Potential range: <span id="muscle-range">0.10-0.25</span>
                        </div>
                    </div>
                    
                    <div class="result-card fat-loss">
                        <h3>Fat Loss</h3>
                        <div class="result-value" id="fat-loss">0.00</div>
                        <div class="result-unit" id="fat-unit">lbs/week</div>
                        <div style="margin-top: 15px; font-size: 0.9rem; color: var(--text-secondary);">
                            <i class="fas fa-arrow-down"></i> Potential range: <span id="fat-range">0.50-1.00</span>
                        </div>
                    </div>
                </div>
                
                <div class="chart-container">
                    <canvas id="recomp-chart"></canvas>
                </div>
                
                <div class="disclaimer">
                    <p><strong><i class="fas fa-exclamation-circle"></i> Important Note:</strong> These estimates assume consistent training, nutrition, and recovery. Individual results may vary due to genetics, age, sleep quality, and other biological factors. Use as a general guideline and consult with a fitness professional for personalized advice.</p>
                </div>
            </div>
        </div>
        
        <!-- Enhanced Signature Section -->
        <div class="signature">
            <p>Created by <span>tommyy.fit</span></p>
        </div>
        
        <footer>
            <p>NeoFit Recomp Calculator &copy; 2023 | Advanced Body Recomposition Analysis</p>
            <p>Results are estimates based on scientific research and statistical modeling</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // DOM Elements
            const weightInput = document.getElementById('weight');
            const proteinInput = document.getElementById('protein');
            const unitLbsBtn = document.getElementById('unit-lbs');
            const unitKgBtn = document.getElementById('unit-kg');
            const calculateBtn = document.getElementById('calculate-btn');
            const resetBtn = document.getElementById('reset-btn');
            const resultsSection = document.getElementById('results');
            const intensityOptions = document.querySelectorAll('.intensity-option');
            const muscleGainEl = document.getElementById('muscle-gain');
            const fatLossEl = document.getElementById('fat-loss');
            const muscleUnitEl = document.getElementById('muscle-unit');
            const fatUnitEl = document.getElementById('fat-unit');
            const muscleRangeEl = document.getElementById('muscle-range');
            const fatRangeEl = document.getElementById('fat-range');
            const weightError = document.getElementById('weight-error');
            const proteinError = document.getElementById('protein-error');
            
            // Chart initialization
            const ctx = document.getElementById('recomp-chart').getContext('2d');
            let recompChart;
            
            // App state
            let currentUnit = 'lbs';
            let currentIntensity = 'beginner';
            
            // Initialize form from localStorage
            function initForm() {
                const savedData = localStorage.getItem('recompData');
                if (savedData) {
                    const data = JSON.parse(savedData);
                    weightInput.value = data.weight || '';
                    proteinInput.value = data.protein || '';
                    currentUnit = data.unit || 'lbs';
                    currentIntensity = data.intensity || 'beginner';
                    
                    // Update UI based on saved data
                    updateUnitUI();
                    updateIntensityUI();
                    
                    // Calculate if we have all data
                    if (data.weight && data.protein) {
                        setTimeout(calculateRecomp, 500);
                    }
                }
            }
            
            // Update unit UI
            function updateUnitUI() {
                if (currentUnit === 'lbs') {
                    unitLbsBtn.classList.add('active');
                    unitKgBtn.classList.remove('active');
                } else {
                    unitKgBtn.classList.add('active');
                    unitLbsBtn.classList.remove('active');
                }
            }
            
            // Update intensity UI
            function updateIntensityUI() {
                intensityOptions.forEach(option => {
                    option.classList.remove('active');
                    if (option.dataset.value === currentIntensity) {
                        option.classList.add('active');
                    }
                });
            }
            
            // Validate inputs
            function validateInputs() {
                let isValid = true;
                
                // Reset errors
                weightInput.classList.remove('invalid');
                proteinInput.classList.remove('invalid');
                weightError.style.display = 'none';
                proteinError.style.display = 'none';
                
                // Validate weight
                const weight = parseFloat(weightInput.value);
                if (isNaN(weight) || weight <= 0) {
                    weightInput.classList.add('invalid');
                    weightError.style.display = 'block';
                    isValid = false;
                }
                
                // Validate protein
                const protein = parseFloat(proteinInput.value);
                if (isNaN(protein) || protein < 0) {
                    proteinInput.classList.add('invalid');
                    proteinError.style.display = 'block';
                    isValid = false;
                }
                
                return isValid;
            }
            
            // Calculate recomp
            function calculateRecomp() {
                if (!validateInputs()) return;
                
                const weight = parseFloat(weightInput.value);
                const protein = parseFloat(proteinInput.value);
                
                // Save to localStorage
                localStorage.setItem('recompData', JSON.stringify({
                    weight,
                    protein,
                    unit: currentUnit,
                    intensity: currentIntensity
                }));
                
                // Convert to lbs for calculations
                const weightLbs = currentUnit === 'kg' ? weight * 2.20462 : weight;
                
                // Calculate protein per lb
                const proteinPerLb = protein / weightLbs;
                
                // Muscle gain calculation
                let muscleBase, muscleMin, muscleMax;
                switch(currentIntensity) {
                    case 'beginner':
                        muscleMin = 0.1;
                        muscleMax = 0.25;
                        muscleBase = (muscleMin + muscleMax) / 2;
                        break;
                    case 'intermediate':
                        muscleMin = 0.25;
                        muscleMax = 0.5;
                        muscleBase = (muscleMin + muscleMax) / 2;
                        break;
                    case 'advanced':
                        muscleMin = 0.5;
                        muscleMax = 1.0;
                        muscleBase = (muscleMin + muscleMax) / 2;
                        break;
                }
                
                // Adjust muscle gain based on protein intake
                let proteinFactor = 1;
                if (proteinPerLb < 0.7) {
                    proteinFactor = 0.8; // Reduce by 20%
                } else if (proteinPerLb > 1.0) {
                    proteinFactor = 1.1; // Increase by 10%
                }
                
                let muscleGain = muscleBase * proteinFactor;
                
                // Apply genetic ceiling (diminishing returns)
                if (currentIntensity === 'advanced' && muscleGain > 0.8) muscleGain = 0.8;
                
                // Fat loss calculation
                let fatLossPercent;
                switch(currentIntensity) {
                    case 'beginner':
                        fatLossPercent = 0.005; // 0.5%
                        break;
                    case 'intermediate':
                        fatLossPercent = 0.0075; // 0.75%
                        break;
                    case 'advanced':
                        fatLossPercent = 0.01; // 1%
                        break;
                }
                
                // Adjust for higher body weight
                if (weightLbs > 150) {
                    const extraWeight = weightLbs - 150;
                    const increments = Math.floor(extraWeight / 10);
                    fatLossPercent += 0.001 * increments; // +0.1% per 10 lbs
                }
                
                // Cap fat loss at 1.5% of body weight
                if (fatLossPercent > 0.015) fatLossPercent = 0.015;
                
                // Calculate fat loss in lbs
                let fatLoss = weightLbs * fatLossPercent;
                
                // Convert results to kg if needed
                let muscleGainOut, fatLossOut;
                if (currentUnit === 'kg') {
                    muscleGainOut = muscleGain * 0.453592;
                    fatLossOut = fatLoss * 0.453592;
                    muscleRangeEl.textContent = `${(muscleMin * 0.453592).toFixed(3)}-${(muscleMax * 0.453592).toFixed(3)}`;
                    fatRangeEl.textContent = `${(0.005 * weightLbs * 0.453592).toFixed(2)}-${(0.015 * weightLbs * 0.453592).toFixed(2)}`;
                } else {
                    muscleGainOut = muscleGain;
                    fatLossOut = fatLoss;
                    muscleRangeEl.textContent = `${muscleMin.toFixed(2)}-${muscleMax.toFixed(2)}`;
                    fatRangeEl.textContent = `${(0.005 * weightLbs).toFixed(2)}-${(0.015 * weightLbs).toFixed(2)}`;
                }
                
                // Update UI with results
                muscleGainEl.textContent = muscleGainOut.toFixed(3);
                fatLossEl.textContent = fatLossOut.toFixed(3);
                muscleUnitEl.textContent = `${currentUnit}/week`;
                fatUnitEl.textContent = `${currentUnit}/week`;
                
                // Show results
                resultsSection.style.display = 'block';
                
                // Update chart
                updateChart(muscleGainOut, fatLossOut);
                
                // Animate results
                animateResults();
            }
            
            // Animate results with counting effect
            function animateResults() {
                const muscleValue = parseFloat(muscleGainEl.textContent);
                const fatValue = parseFloat(fatLossEl.textContent);
                
                animateValue(muscleGainEl, 0, muscleValue, 1500);
                animateValue(fatLossEl, 0, fatValue, 1500);
            }
            
            function animateValue(element, start, end, duration) {
                let startTimestamp = null;
                const step = (timestamp) => {
                    if (!startTimestamp) startTimestamp = timestamp;
                    const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                    const value = progress * (end - start) + start;
                    element.textContent = value.toFixed(3);
                    if (progress < 1) {
                        window.requestAnimationFrame(step);
                    }
                };
                window.requestAnimationFrame(step);
            }
            
            // Update chart
            function updateChart(muscleGain, fatLoss) {
                if (recompChart) {
                    recompChart.destroy();
                }
                
                recompChart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['Muscle Gain', 'Fat Loss'],
                        datasets: [{
                            label: `Weekly Change (${currentUnit})`,
                            data: [muscleGain, fatLoss],
                            backgroundColor: [
                                'rgba(0, 255, 157, 0.7)',
                                'rgba(255, 77, 126, 0.7)'
                            ],
                            borderColor: [
                                'rgba(0, 255, 157, 1)',
                                'rgba(255, 77, 126, 1)'
                            ],
                            borderWidth: 2,
                            borderRadius: 10,
                            borderSkipped: false,
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                backgroundColor: 'rgba(15, 23, 42, 0.9)',
                                titleColor: '#00d9ff',
                                bodyColor: '#f8fafc',
                                borderColor: 'rgba(0, 217, 255, 0.5)',
                                borderWidth: 1,
                                padding: 12,
                                callbacks: {
                                    label: function(context) {
                                        return `${context.dataset.label}: ${context.parsed.y.toFixed(3)} ${currentUnit}`;
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                },
                                ticks: {
                                    color: '#94a3b8'
                                },
                                title: {
                                    display: true,
                                    text: `${currentUnit} per week`,
                                    color: '#94a3b8'
                                }
                            },
                            x: {
                                grid: {
                                    display: false
                                },
                                ticks: {
                                    color: '#f8fafc',
                                    font: {
                                        weight: 'bold'
                                    }
                                }
                            }
                        }
                    }
                });
            }
            
            // Reset form
            function resetForm() {
                weightInput.value = '';
                proteinInput.value = '';
                currentUnit = 'lbs';
                currentIntensity = 'beginner';
                updateUnitUI();
                updateIntensityUI();
                resultsSection.style.display = 'none';
                localStorage.removeItem('recompData');
                
                // Reset errors
                weightInput.classList.remove('invalid');
                proteinInput.classList.remove('invalid');
                weightError.style.display = 'none';
                proteinError.style.display = 'none';
            }
            
            // Event Listeners
            unitLbsBtn.addEventListener('click', () => {
                currentUnit = 'lbs';
                updateUnitUI();
                if (weightInput.value && proteinInput.value) {
                    calculateRecomp();
                }
            });
            
            unitKgBtn.addEventListener('click', () => {
                currentUnit = 'kg';
                updateUnitUI();
                if (weightInput.value && proteinInput.value) {
                    calculateRecomp();
                }
            });
            
            intensityOptions.forEach(option => {
                option.addEventListener('click', () => {
                    currentIntensity = option.dataset.value;
                    updateIntensityUI();
                    if (weightInput.value && proteinInput.value) {
                        calculateRecomp();
                    }
                });
            });
            
            calculateBtn.addEventListener('click', calculateRecomp);
            resetBtn.addEventListener('click', resetForm);
            
            // Add real-time validation
            weightInput.addEventListener('input', function() {
                if (this.value && proteinInput.value) {
                    calculateRecomp();
                }
            });
            
            proteinInput.addEventListener('input', function() {
                if (this.value && weightInput.value) {
                    calculateRecomp();
                }
            });
            
            // Initialize form
            initForm();
        });
    </script>
</body>
</html>